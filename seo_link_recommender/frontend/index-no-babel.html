<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SEO Link Recommender - No Babel</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css" />
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <!-- Ð£Ð±Ð¸Ñ€Ð°ÐµÐ¼ Babel! -->
  <style>
    /* Ð¢Ð¾Ñ‚ Ð¶Ðµ CSS Ñ‡Ñ‚Ð¾ Ð¸ Ñ€Ð°Ð½ÑŒÑˆÐµ */
    .hero-apple {
      background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
      color: white;
      padding: 40px 20px;
      text-align: center;
    }
    
    .btn-apple {
      padding: 12px 24px;
      margin: 8px;
      border: none;
      border-radius: 8px;
      background: #007AFF;
      color: white;
      cursor: pointer;
    }
    
    .card {
      background: white;
      border-radius: 12px;
      padding: 20px;
      margin: 20px;
      box-shadow: 0 4px 16px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body>
  <div id="app"></div>
  
  <script>
    // React Ð±ÐµÐ· JSX - Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ createElement
    const { useState, useEffect, createElement: h } = React;
    
    function App() {
      const [domain, setDomain] = useState('');
      const [currentView, setCurrentView] = useState('domains');
      const [domains, setDomains] = useState([]);
      
      useEffect(() => {
        console.log('ðŸš€ SEO Link Recommender Ð·Ð°Ð³Ñ€ÑƒÐ¶ÐµÐ½ Ð‘Ð•Ð— Babel!');
        loadDomains();
      }, []);
      
      async function loadDomains() {
        try {
          const response = await fetch('/api/v1/domains');
          const data = await response.json();
          setDomains(data.domains || []);
        } catch (error) {
          console.error('ÐžÑˆÐ¸Ð±ÐºÐ° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð´Ð¾Ð¼ÐµÐ½Ð¾Ð²:', error);
        }
      }
      
      async function handleAnalyzeDomain() {
        if (!domain.trim()) return;
        
        try {
          const response = await fetch('/api/v1/wp_index', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
              domain: domain.trim(),
              comprehensive: true
            })
          });
          
          const result = await response.json();
          console.log('Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚ Ð°Ð½Ð°Ð»Ð¸Ð·Ð°:', result);
          loadDomains(); // ÐžÐ±Ð½Ð¾Ð²Ð»ÑÐµÐ¼ ÑÐ¿Ð¸ÑÐ¾Ðº Ð´Ð¾Ð¼ÐµÐ½Ð¾Ð²
        } catch (error) {
          console.error('ÐžÑˆÐ¸Ð±ÐºÐ° Ð°Ð½Ð°Ð»Ð¸Ð·Ð°:', error);
        }
      }
      
      // ÐšÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ñ‹ Ð±ÐµÐ· JSX
      const Header = () => h('div', { className: 'hero-apple' },
        h('h1', { className: 'title' }, 'ðŸ”— SEO Link Recommender'),
        h('p', { className: 'subtitle' }, 'Ð˜Ð½Ñ‚ÐµÐ»Ð»ÐµÐºÑ‚ÑƒÐ°Ð»ÑŒÐ½Ð°Ñ Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ Ð²Ð½ÑƒÑ‚Ñ€ÐµÐ½Ð½Ð¸Ñ… ÑÑÑ‹Ð»Ð¾Ðº')
      );
      
      const DomainInput = () => h('div', { className: 'card' },
        h('h2', { className: 'subtitle' }, 'ÐÐ½Ð°Ð»Ð¸Ð· Ð½Ð¾Ð²Ð¾Ð³Ð¾ Ð´Ð¾Ð¼ÐµÐ½Ð°'),
        h('div', { className: 'field has-addons' },
          h('div', { className: 'control is-expanded' },
            h('input', {
              className: 'input',
              type: 'text',
              placeholder: 'example.com',
              value: domain,
              onChange: (e) => setDomain(e.target.value),
              onKeyPress: (e) => e.key === 'Enter' && handleAnalyzeDomain()
            })
          ),
          h('div', { className: 'control' },
            h('button', {
              className: 'btn-apple',
              onClick: handleAnalyzeDomain,
              disabled: !domain.trim()
            }, 'ðŸš€ ÐÐ½Ð°Ð»Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ')
          )
        )
      );
      
      const DomainsList = () => h('div', { className: 'card' },
        h('h2', { className: 'subtitle' }, `ðŸ“Š ÐŸÑ€Ð¾Ð¸Ð½Ð´ÐµÐºÑÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ðµ Ð´Ð¾Ð¼ÐµÐ½Ñ‹ (${domains.length})`),
        domains.length === 0 
          ? h('p', { className: 'has-text-grey' }, 'ÐŸÐ¾ÐºÐ° Ð½ÐµÑ‚ Ð¿Ñ€Ð¾Ð¸Ð½Ð´ÐµÐºÑÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ñ… Ð´Ð¾Ð¼ÐµÐ½Ð¾Ð²')
          : h('div', { className: 'content' },
              domains.map(domain => 
                h('div', { 
                  key: domain.id,
                  className: 'box',
                  style: { marginBottom: '12px' }
                },
                  h('div', { style: { display: 'flex', justifyContent: 'space-between', alignItems: 'center' } },
                    h('div', null,
                      h('strong', null, domain.display_name),
                      h('br'),
                      h('small', { className: 'has-text-grey' }, 
                        `${domain.total_posts} ÑÑ‚Ð°Ñ‚ÐµÐ¹ | ${domain.total_analyses} Ð°Ð½Ð°Ð»Ð¸Ð·Ð¾Ð²`
                      )
                    ),
                    h('button', {
                      className: 'btn-apple',
                      onClick: () => handleAnalyzeDomain()
                    }, 'ðŸ”„ ÐŸÐµÑ€ÐµÐ°Ð½Ð°Ð»Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ')
                  )
                )
              )
            )
      );
      
      // Ð“Ð»Ð°Ð²Ð½Ñ‹Ð¹ ÐºÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚
      return h('div', null,
        Header(),
        h('div', { className: 'container', style: { padding: '20px' } },
          DomainInput(),
          DomainsList()
        )
      );
    }
    
    // Ð ÐµÐ½Ð´ÐµÑ€Ð¸Ð¼ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ Ð‘Ð•Ð— Babel
    const root = ReactDOM.createRoot(document.getElementById('app'));
    root.render(h(App));
  </script>
</body>
</html> 