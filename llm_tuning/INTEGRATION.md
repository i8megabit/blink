# üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è LLM Tuning —Å reLink

## üìã –û–±–∑–æ—Ä –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

LLM Tuning Microservice –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è —Å –æ—Å–Ω–æ–≤–Ω—ã–º –ø—Ä–æ–µ–∫—Ç–æ–º reLink –¥–ª—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —è–∑—ã–∫–æ–≤—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é, –æ—Ü–µ–Ω–∫—É –∫–∞—á–µ—Å—Ç–≤–∞ –∏ RAG —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å.

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                        reLink Frontend                      ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îÇ
‚îÇ  ‚îÇ   SEO App   ‚îÇ  ‚îÇ Content Gen ‚îÇ  ‚îÇ Analytics   ‚îÇ         ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                              ‚îÇ
                              ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                     reLink Backend                          ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îÇ
‚îÇ  ‚îÇ   API GW    ‚îÇ  ‚îÇ   Cache     ‚îÇ  ‚îÇ   Auth      ‚îÇ         ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                              ‚îÇ
                              ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                   LLM Tuning Microservice                   ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îÇ
‚îÇ  ‚îÇ A/B Testing ‚îÇ  ‚îÇ Optimization‚îÇ  ‚îÇ Quality     ‚îÇ         ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îÇ
‚îÇ  ‚îÇ RAG Service ‚îÇ  ‚îÇ Monitoring  ‚îÇ  ‚îÇ Utils       ‚îÇ         ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                              ‚îÇ
                              ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    External Services                        ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îÇ
‚îÇ  ‚îÇ   Ollama    ‚îÇ  ‚îÇ PostgreSQL  ‚îÇ  ‚îÇ   Redis     ‚îÇ         ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îÇ
‚îÇ  ‚îÇ   Qdrant    ‚îÇ  ‚îÇ Prometheus  ‚îÇ  ‚îÇ   Grafana   ‚îÇ         ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### 1. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è reLink Backend

–û–±–Ω–æ–≤–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –æ—Å–Ω–æ–≤–Ω–æ–≥–æ backend –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å LLM Tuning:

```python
# relink/backend/app/config.py

class Settings(BaseSettings):
    # –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏...
    
    # LLM Tuning –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
    llm_tuning_enabled: bool = True
    llm_tuning_url: str = "http://localhost:8000"
    llm_tuning_api_key: str = "your-api-key"
    
    # A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
    ab_testing_enabled: bool = True
    default_ab_test_traffic_split: float = 0.5
    
    # RAG –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
    rag_enabled: bool = True
    rag_collection_name: str = "relink_docs"
    
    # –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
    quality_assessment_enabled: bool = True
    min_quality_score: float = 7.0
```

### 2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# relink/backend/.env

# LLM Tuning –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
LLM_TUNING_ENABLED=true
LLM_TUNING_URL=http://localhost:8000
LLM_TUNING_API_KEY=your-api-key

# A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
AB_TESTING_ENABLED=true
DEFAULT_AB_TEST_TRAFFIC_SPLIT=0.5

# RAG –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
RAG_ENABLED=true
RAG_COLLECTION_NAME=relink_docs

# –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
QUALITY_ASSESSMENT_ENABLED=true
MIN_QUALITY_SCORE=7.0
```

### 3. Docker Compose –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

```yaml
# relink/docker-compose.yml

version: '3.8'

services:
  # –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–µ—Ä–≤–∏—Å—ã...
  
  llm_tuning:
    build: ./llm_tuning
    ports:
      - "8000:8000"
    environment:
      - DATABASE_URL=postgresql://user:pass@db/llm_tuning
      - OLLAMA_BASE_URL=http://ollama:11434
      - REDIS_URL=redis://redis:6379
      - VECTOR_DB_URL=http://qdrant:6333
    depends_on:
      - db
      - redis
      - ollama
      - qdrant
    networks:
      - relink_network

  # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ backend –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
  backend:
    build: ./backend
    environment:
      - LLM_TUNING_URL=http://llm_tuning:8000
      - LLM_TUNING_API_KEY=your-api-key
    depends_on:
      - llm_tuning
    networks:
      - relink_network

networks:
  relink_network:
    driver: bridge
```

---

## üîå –ö–ª–∏–µ–Ω—Ç –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞

```python
# relink/backend/app/llm_client.py

import aiohttp
import asyncio
from typing import Dict, List, Optional
from pydantic import BaseModel
import logging

logger = logging.getLogger(__name__)

class LLMTuningClient:
    """–ö–ª–∏–µ–Ω—Ç –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å LLM Tuning Microservice"""
    
    def __init__(self, base_url: str, api_key: str):
        self.base_url = base_url.rstrip('/')
        self.api_key = api_key
        self.session: Optional[aiohttp.ClientSession] = None
    
    async def __aenter__(self):
        self.session = aiohttp.ClientSession(
            headers={"Authorization": f"Bearer {self.api_key}"}
        )
        return self
    
    async def __aexit__(self, exc_type, exc_val, exc_tb):
        if self.session:
            await self.session.close()
    
    async def _make_request(self, method: str, endpoint: str, data: Dict = None) -> Dict:
        """–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ HTTP –∑–∞–ø—Ä–æ—Å–∞"""
        if not self.session:
            raise RuntimeError("Client not initialized. Use async context manager.")
        
        url = f"{self.base_url}{endpoint}"
        try:
            async with self.session.request(method, url, json=data) as response:
                response.raise_for_status()
                return await response.json()
        except aiohttp.ClientError as e:
            logger.error(f"LLM Tuning request failed: {e}")
            raise
    
    # A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
    async def create_ab_test(self, test_config: Dict) -> Dict:
        """–°–æ–∑–¥–∞–Ω–∏–µ A/B —Ç–µ—Å—Ç–∞"""
        return await self._make_request("POST", "/api/v1/ab-tests", test_config)
    
    async def select_model_for_ab_test(self, test_id: int, request_type: str, user_id: str) -> Dict:
        """–í—ã–±–æ—Ä –º–æ–¥–µ–ª–∏ –¥–ª—è A/B —Ç–µ—Å—Ç–∞"""
        data = {
            "request_type": request_type,
            "user_id": user_id
        }
        return await self._make_request("POST", f"/api/v1/ab-tests/{test_id}/select-model", data)
    
    async def record_ab_test_result(self, test_id: int, session_id: str, variant: str, metrics: Dict) -> Dict:
        """–ó–∞–ø–∏—Å—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ A/B —Ç–µ—Å—Ç–∞"""
        data = {
            "session_id": session_id,
            "variant": variant,
            "metrics": metrics
        }
        return await self._make_request("POST", f"/api/v1/ab-tests/{test_id}/results", data)
    
    # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
    async def optimize_model(self, optimization_config: Dict) -> Dict:
        """–ó–∞–ø—É—Å–∫ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –º–æ–¥–µ–ª–∏"""
        return await self._make_request("POST", "/api/v1/optimization", optimization_config)
    
    async def get_optimization_status(self, optimization_id: int) -> Dict:
        """–ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏"""
        return await self._make_request("GET", f"/api/v1/optimization/{optimization_id}")
    
    # –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞
    async def assess_quality(self, assessment_data: Dict) -> Dict:
        """–û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞"""
        return await self._make_request("POST", "/api/v1/quality/assess", assessment_data)
    
    async def get_quality_stats(self, model_id: int, days: int = 30) -> Dict:
        """–ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞"""
        return await self._make_request("GET", f"/api/v1/quality/stats?model_id={model_id}&days={days}")
    
    # RAG –æ–ø–µ—Ä–∞—Ü–∏–∏
    async def search_documents(self, query: str, collection: str = "relink_docs", top_k: int = 5) -> Dict:
        """–ü–æ–∏—Å–∫ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ RAG"""
        data = {
            "query": query,
            "collection": collection,
            "top_k": top_k
        }
        return await self._make_request("POST", "/api/v1/rag/search", data)
    
    async def generate_with_context(self, query: str, context_docs: List[Dict], model_name: str) -> Dict:
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º"""
        data = {
            "query": query,
            "context_docs": context_docs,
            "model_name": model_name
        }
        return await self._make_request("POST", "/api/v1/rag/generate", data)
    
    # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
    async def get_system_health(self) -> Dict:
        """–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã"""
        return await self._make_request("GET", "/api/v1/health")
    
    async def get_model_stats(self, model_id: int, days: int = 30) -> Dict:
        """–ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –º–æ–¥–µ–ª–∏"""
        return await self._make_request("GET", f"/api/v1/stats/model/{model_id}?days={days}")
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Å–µ—Ä–≤–∏—Å—ã

```python
# relink/backend/app/services/seo_service.py

from app.llm_client import LLMTuningClient
from app.config import settings
import asyncio

class SEOService:
    """–°–µ—Ä–≤–∏—Å –¥–ª—è SEO –∞–Ω–∞–ª–∏–∑–∞ —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π LLM Tuning"""
    
    def __init__(self):
        self.llm_client = None
    
    async def get_llm_client(self) -> LLMTuningClient:
        """–ü–æ–ª—É—á–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞ LLM Tuning"""
        if not self.llm_client:
            self.llm_client = LLMTuningClient(
                settings.llm_tuning_url,
                settings.llm_tuning_api_key
            )
        return self.llm_client
    
    async def analyze_website_seo(self, domain: str, user_id: str) -> Dict:
        """–ê–Ω–∞–ª–∏–∑ SEO —Å–∞–π—Ç–∞ —Å A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º"""
        async with await self.get_llm_client() as client:
            # –°–æ–∑–¥–∞–Ω–∏–µ A/B —Ç–µ—Å—Ç–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
            ab_test = await client.create_ab_test({
                "name": f"SEO Analysis - {domain}",
                "description": f"–ê–Ω–∞–ª–∏–∑ SEO –¥–ª—è –¥–æ–º–µ–Ω–∞ {domain}",
                "model_id": 1,
                "variant_a": {"name": "llama2:7b", "parameters": {"temperature": 0.7}},
                "variant_b": {"name": "llama2:13b", "parameters": {"temperature": 0.7}},
                "traffic_split": settings.default_ab_test_traffic_split,
                "test_duration_days": 1,
                "success_metrics": ["analysis_quality", "response_time", "user_satisfaction"]
            })
            
            # –í—ã–±–æ—Ä –º–æ–¥–µ–ª–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
            model_info = await client.select_model_for_ab_test(
                test_id=ab_test['id'],
                request_type="seo_analysis",
                user_id=user_id
            )
            
            # –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∞–Ω–∞–ª–∏–∑–∞
            analysis_result = await self._perform_seo_analysis(domain, model_info)
            
            # –ó–∞–ø–∏—Å—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
            await client.record_ab_test_result(
                test_id=ab_test['id'],
                session_id=model_info['session_id'],
                variant=model_info['selected_variant'],
                metrics={
                    "analysis_quality": analysis_result['quality_score'],
                    "response_time": analysis_result['response_time'],
                    "user_satisfaction": analysis_result['user_satisfaction']
                }
            )
            
            return analysis_result
    
    async def generate_seo_content(self, topic: str, keywords: List[str], user_id: str) -> Dict:
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è SEO –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —Å RAG"""
        async with await self.get_llm_client() as client:
            # –ü–æ–∏—Å–∫ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
            search_results = await client.search_documents(
                query=f"{topic} {' '.join(keywords)}",
                collection=settings.rag_collection_name,
                top_k=5
            )
            
            # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
            generation_result = await client.generate_with_context(
                query=f"–°–æ–∑–¥–∞–π SEO-–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å—Ç–∞—Ç—å—é –æ {topic} —Å –∫–ª—é—á–µ–≤—ã–º–∏ —Å–ª–æ–≤–∞–º–∏: {', '.join(keywords)}",
                context_docs=search_results['results'],
                model_name="llama2:7b"
            )
            
            # –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞
            if settings.quality_assessment_enabled:
                quality_assessment = await client.assess_quality({
                    "model_id": 1,
                    "request_text": f"–°–æ–∑–¥–∞–π SEO-–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å—Ç–∞—Ç—å—é –æ {topic}",
                    "response_text": generation_result['answer'],
                    "assessment_criteria": ["relevance", "accuracy", "seo_optimization", "readability"]
                })
                
                # –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞
                if quality_assessment['overall_score'] < settings.min_quality_score:
                    logger.warning(f"Generated content quality below threshold: {quality_assessment['overall_score']}")
            
            return {
                "content": generation_result['answer'],
                "sources": generation_result['sources'],
                "quality_score": quality_assessment['overall_score'] if settings.quality_assessment_enabled else None,
                "metadata": generation_result['metadata']
            }
    
    async def optimize_content_quality(self, content: str, target_score: float = 8.0) -> Dict:
        """–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞"""
        async with await self.get_llm_client() as client:
            # –ó–∞–ø—É—Å–∫ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
            optimization = await client.optimize_model({
                "model_id": 1,
                "optimization_type": "quality",
                "target_metrics": {
                    "quality_score": target_score
                },
                "optimization_strategies": [
                    "prompt_engineering",
                    "parameter_tuning"
                ]
            })
            
            return optimization
```

---

## üé® –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ Frontend

### React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

```typescript
// relink/frontend/src/components/LLMTuningIntegration.tsx

import React, { useState, useEffect } from 'react';
import { useApi } from '../hooks/useApi';

interface ABTestResult {
  test_id: number;
  variant: string;
  metrics: {
    response_time: number;
    quality_score: number;
    user_satisfaction: number;
  };
}

interface QualityAssessment {
  overall_score: number;
  detailed_scores: Record<string, number>;
  feedback: {
    strengths: string[];
    improvements: string[];
  };
}

export const LLMTuningIntegration: React.FC = () => {
  const [abTestResults, setAbTestResults] = useState<ABTestResult[]>([]);
  const [qualityAssessments, setQualityAssessments] = useState<QualityAssessment[]>([]);
  const [systemHealth, setSystemHealth] = useState<any>(null);
  
  const { get, post } = useApi();
  
  // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ A/B —Ç–µ—Å—Ç–æ–≤
  const fetchABTestResults = async () => {
    try {
      const response = await get('/api/llm-tuning/ab-tests/results');
      setAbTestResults(response.data);
    } catch (error) {
      console.error('Failed to fetch A/B test results:', error);
    }
  };
  
  // –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ü–µ–Ω–æ–∫ –∫–∞—á–µ—Å—Ç–≤–∞
  const fetchQualityAssessments = async () => {
    try {
      const response = await get('/api/llm-tuning/quality/assessments');
      setQualityAssessments(response.data);
    } catch (error) {
      console.error('Failed to fetch quality assessments:', error);
    }
  };
  
  // –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã
  const fetchSystemHealth = async () => {
    try {
      const response = await get('/api/llm-tuning/health');
      setSystemHealth(response.data);
    } catch (error) {
      console.error('Failed to fetch system health:', error);
    }
  };
  
  useEffect(() => {
    fetchABTestResults();
    fetchQualityAssessments();
    fetchSystemHealth();
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
    const interval = setInterval(() => {
      fetchSystemHealth();
    }, 30000);
    
    return () => clearInterval(interval);
  }, []);
  
  return (
    <div className="space-y-6">
      {/* A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ */}
      <div className="bg-white rounded-lg shadow p-6">
        <h3 className="text-lg font-semibold mb-4">A/B –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</h3>
        <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
          {abTestResults.map((result) => (
            <div key={result.test_id} className="border rounded p-4">
              <h4 className="font-medium">–¢–µ—Å—Ç #{result.test_id}</h4>
              <p className="text-sm text-gray-600">–í–∞—Ä–∏–∞–Ω—Ç: {result.variant}</p>
              <div className="mt-2 space-y-1">
                <p className="text-xs">–í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞: {result.metrics.response_time}s</p>
                <p className="text-xs">–ö–∞—á–µ—Å—Ç–≤–æ: {result.metrics.quality_score}/10</p>
                <p className="text-xs">–£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç—å: {result.metrics.user_satisfaction}/5</p>
              </div>
            </div>
          ))}
        </div>
      </div>
      
      {/* –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ */}
      <div className="bg-white rounded-lg shadow p-6">
        <h3 className="text-lg font-semibold mb-4">–û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</h3>
        <div className="space-y-4">
          {qualityAssessments.map((assessment, index) => (
            <div key={index} className="border rounded p-4">
              <div className="flex items-center justify-between mb-2">
                <span className="font-medium">–û–±—â–∏–π –±–∞–ª–ª: {assessment.overall_score}/10</span>
                <div className={`px-2 py-1 rounded text-xs ${
                  assessment.overall_score >= 8 ? 'bg-green-100 text-green-800' :
                  assessment.overall_score >= 6 ? 'bg-yellow-100 text-yellow-800' :
                  'bg-red-100 text-red-800'
                }`}>
                  {assessment.overall_score >= 8 ? '–û—Ç–ª–∏—á–Ω–æ' :
                   assessment.overall_score >= 6 ? '–•–æ—Ä–æ—à–æ' : '–¢—Ä–µ–±—É–µ—Ç —É–ª—É—á—à–µ–Ω–∏—è'}
                </div>
              </div>
              <div className="grid grid-cols-2 md:grid-cols-4 gap-2 text-sm">
                {Object.entries(assessment.detailed_scores).map(([criterion, score]) => (
                  <div key={criterion}>
                    <span className="text-gray-600">{criterion}:</span>
                    <span className="ml-1 font-medium">{score}/10</span>
                  </div>
                ))}
              </div>
            </div>
          ))}
        </div>
      </div>
      
      {/* –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã */}
      {systemHealth && (
        <div className="bg-white rounded-lg shadow p-6">
          <h3 className="text-lg font-semibold mb-4">–°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã</h3>
          <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
            <div className="text-center">
              <div className="text-2xl font-bold text-blue-600">
                {systemHealth.components?.ollama?.status === 'healthy' ? '‚úÖ' : '‚ùå'}
              </div>
              <p className="text-sm text-gray-600">Ollama</p>
            </div>
            <div className="text-center">
              <div className="text-2xl font-bold text-green-600">
                {systemHealth.components?.database?.status === 'healthy' ? '‚úÖ' : '‚ùå'}
              </div>
              <p className="text-sm text-gray-600">–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö</p>
            </div>
            <div className="text-center">
              <div className="text-2xl font-bold text-purple-600">
                {systemHealth.components?.vector_db?.status === 'healthy' ? '‚úÖ' : '‚ùå'}
              </div>
              <p className="text-sm text-gray-600">Vector DB</p>
            </div>
            <div className="text-center">
              <div className="text-2xl font-bold text-orange-600">
                {systemHealth.components?.redis?.status === 'healthy' ? '‚úÖ' : '‚ùå'}
              </div>
              <p className="text-sm text-gray-600">Redis</p>
            </div>
          </div>
          <div className="mt-4 grid grid-cols-2 md:grid-cols-4 gap-4 text-sm">
            <div>
              <span className="text-gray-600">CPU:</span>
              <span className="ml-1 font-medium">{systemHealth.system_metrics?.cpu_usage?.toFixed(1)}%</span>
            </div>
            <div>
              <span className="text-gray-600">–ü–∞–º—è—Ç—å:</span>
              <span className="ml-1 font-medium">{systemHealth.system_metrics?.memory_usage?.toFixed(0)}MB</span>
            </div>
            <div>
              <span className="text-gray-600">–ó–∞–ø—Ä–æ—Å–æ–≤/—Å–µ–∫:</span>
              <span className="ml-1 font-medium">{systemHealth.application_metrics?.requests_per_second?.toFixed(0)}</span>
            </div>
            <div>
              <span className="text-gray-600">–û—à–∏–±–æ–∫:</span>
              <span className="ml-1 font-medium">{systemHealth.application_metrics?.error_rate?.toFixed(2)}%</span>
            </div>
          </div>
        </div>
      )}
    </div>
  );
};
```

### API —Ö—É–∫–∏

```typescript
// relink/frontend/src/hooks/useLLMTuning.ts

import { useState, useCallback } from 'react';
import { useApi } from './useApi';

export const useLLMTuning = () => {
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const { get, post } = useApi();
  
  // A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
  const createABTest = useCallback(async (testConfig: any) => {
    setLoading(true);
    setError(null);
    try {
      const response = await post('/api/llm-tuning/ab-tests', testConfig);
      return response.data;
    } catch (err: any) {
      setError(err.message);
      throw err;
    } finally {
      setLoading(false);
    }
  }, [post]);
  
  const selectModelForABTest = useCallback(async (testId: number, requestType: string, userId: string) => {
    setLoading(true);
    setError(null);
    try {
      const response = await post(`/api/llm-tuning/ab-tests/${testId}/select-model`, {
        request_type: requestType,
        user_id: userId
      });
      return response.data;
    } catch (err: any) {
      setError(err.message);
      throw err;
    } finally {
      setLoading(false);
    }
  }, [post]);
  
  // –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞
  const assessQuality = useCallback(async (assessmentData: any) => {
    setLoading(true);
    setError(null);
    try {
      const response = await post('/api/llm-tuning/quality/assess', assessmentData);
      return response.data;
    } catch (err: any) {
      setError(err.message);
      throw err;
    } finally {
      setLoading(false);
    }
  }, [post]);
  
  // RAG –æ–ø–µ—Ä–∞—Ü–∏–∏
  const searchDocuments = useCallback(async (query: string, collection: string = 'relink_docs') => {
    setLoading(true);
    setError(null);
    try {
      const response = await post('/api/llm-tuning/rag/search', {
        query,
        collection,
        top_k: 5
      });
      return response.data;
    } catch (err: any) {
      setError(err.message);
      throw err;
    } finally {
      setLoading(false);
    }
  }, [post]);
  
  const generateWithContext = useCallback(async (query: string, contextDocs: any[], modelName: string) => {
    setLoading(true);
    setError(null);
    try {
      const response = await post('/api/llm-tuning/rag/generate', {
        query,
        context_docs: contextDocs,
        model_name: modelName
      });
      return response.data;
    } catch (err: any) {
      setError(err.message);
      throw err;
    } finally {
      setLoading(false);
    }
  }, [post]);
  
  // –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
  const getSystemHealth = useCallback(async () => {
    setLoading(true);
    setError(null);
    try {
      const response = await get('/api/llm-tuning/health');
      return response.data;
    } catch (err: any) {
      setError(err.message);
      throw err;
    } finally {
      setLoading(false);
    }
  }, [get]);
  
  return {
    loading,
    error,
    createABTest,
    selectModelForABTest,
    assessQuality,
    searchDocuments,
    generateWithContext,
    getSystemHealth
  };
};
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

```python
# relink/backend/tests/test_llm_tuning_integration.py

import pytest
import asyncio
from unittest.mock import AsyncMock, patch
from app.llm_client import LLMTuningClient
from app.services.seo_service import SEOService

class TestLLMTuningIntegration:
    """–¢–µ—Å—Ç—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å LLM Tuning"""
    
    @pytest.fixture
    async def llm_client(self):
        """–§–∏–∫—Å—Ç—É—Ä–∞ –∫–ª–∏–µ–Ω—Ç–∞ LLM Tuning"""
        async with LLMTuningClient("http://localhost:8000", "test-key") as client:
            yield client
    
    @pytest.fixture
    def seo_service(self):
        """–§–∏–∫—Å—Ç—É—Ä–∞ SEO —Å–µ—Ä–≤–∏—Å–∞"""
        return SEOService()
    
    @pytest.mark.asyncio
    async def test_ab_test_creation(self, llm_client):
        """–¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è A/B —Ç–µ—Å—Ç–∞"""
        test_config = {
            "name": "Test SEO Analysis",
            "description": "Test description",
            "model_id": 1,
            "variant_a": {"name": "llama2:7b"},
            "variant_b": {"name": "llama2:13b"},
            "traffic_split": 0.5,
            "test_duration_days": 1,
            "success_metrics": ["response_time", "quality_score"]
        }
        
        result = await llm_client.create_ab_test(test_config)
        
        assert result["name"] == "Test SEO Analysis"
        assert result["status"] == "active"
        assert "id" in result
    
    @pytest.mark.asyncio
    async def test_model_selection(self, llm_client):
        """–¢–µ—Å—Ç –≤—ã–±–æ—Ä–∞ –º–æ–¥–µ–ª–∏ –¥–ª—è A/B —Ç–µ—Å—Ç–∞"""
        test_id = 1
        
        result = await llm_client.select_model_for_ab_test(
            test_id=test_id,
            request_type="seo_analysis",
            user_id="test_user"
        )
        
        assert "selected_variant" in result
        assert "model_name" in result
        assert "session_id" in result
    
    @pytest.mark.asyncio
    async def test_quality_assessment(self, llm_client):
        """–¢–µ—Å—Ç –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞"""
        assessment_data = {
            "model_id": 1,
            "request_text": "Test request",
            "response_text": "Test response",
            "assessment_criteria": ["relevance", "accuracy"]
        }
        
        result = await llm_client.assess_quality(assessment_data)
        
        assert "overall_score" in result
        assert "detailed_scores" in result
        assert result["overall_score"] >= 0
        assert result["overall_score"] <= 10
    
    @pytest.mark.asyncio
    async def test_rag_search(self, llm_client):
        """–¢–µ—Å—Ç –ø–æ–∏—Å–∫–∞ –≤ RAG"""
        query = "SEO optimization"
        
        result = await llm_client.search_documents(query)
        
        assert "results" in result
        assert "total_found" in result
        assert isinstance(result["results"], list)
    
    @pytest.mark.asyncio
    async def test_seo_service_integration(self, seo_service):
        """–¢–µ—Å—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ SEO —Å–µ—Ä–≤–∏—Å"""
        with patch.object(seo_service, 'get_llm_client') as mock_get_client:
            mock_client = AsyncMock()
            mock_get_client.return_value = mock_client
            
            # –ú–æ–∫–∞–µ–º –æ—Ç–≤–µ—Ç—ã –∫–ª–∏–µ–Ω—Ç–∞
            mock_client.create_ab_test.return_value = {
                "id": 1, "name": "Test", "status": "active"
            }
            mock_client.select_model_for_ab_test.return_value = {
                "selected_variant": "a", "model_name": "llama2:7b", "session_id": "session_123"
            }
            
            result = await seo_service.analyze_website_seo("example.com", "user_123")
            
            assert result is not None
            mock_client.create_ab_test.assert_called_once()
            mock_client.select_model_for_ab_test.assert_called_once()
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### –ú–µ—Ç—Ä–∏–∫–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

```python
# relink/backend/app/monitoring/llm_tuning_metrics.py

from prometheus_client import Counter, Histogram, Gauge
import time

# –ú–µ—Ç—Ä–∏–∫–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
llm_tuning_requests_total = Counter(
    'llm_tuning_requests_total',
    'Total number of LLM Tuning requests',
    ['endpoint', 'method', 'status']
)

llm_tuning_request_duration = Histogram(
    'llm_tuning_request_duration_seconds',
    'Duration of LLM Tuning requests',
    ['endpoint']
)

llm_tuning_ab_test_results = Counter(
    'llm_tuning_ab_test_results_total',
    'Total number of A/B test results',
    ['test_id', 'variant', 'metric']
)

llm_tuning_quality_scores = Histogram(
    'llm_tuning_quality_scores',
    'Quality assessment scores',
    ['model_id', 'criteria']
)

llm_tuning_rag_operations = Counter(
    'llm_tuning_rag_operations_total',
    'Total number of RAG operations',
    ['operation_type', 'collection']
)

llm_tuning_system_health = Gauge(
    'llm_tuning_system_health',
    'System health status',
    ['component']
)

class LLMTuningMetrics:
    """–ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å LLM Tuning"""
    
    @staticmethod
    def record_request(endpoint: str, method: str, status: str, duration: float):
        """–ó–∞–ø–∏—Å—å –º–µ—Ç—Ä–∏–∫–∏ –∑–∞–ø—Ä–æ—Å–∞"""
        llm_tuning_requests_total.labels(endpoint=endpoint, method=method, status=status).inc()
        llm_tuning_request_duration.labels(endpoint=endpoint).observe(duration)
    
    @staticmethod
    def record_ab_test_result(test_id: int, variant: str, metric: str, value: float):
        """–ó–∞–ø–∏—Å—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ A/B —Ç–µ—Å—Ç–∞"""
        llm_tuning_ab_test_results.labels(
            test_id=str(test_id), 
            variant=variant, 
            metric=metric
        ).inc()
    
    @staticmethod
    def record_quality_score(model_id: int, criteria: str, score: float):
        """–ó–∞–ø–∏—Å—å –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞"""
        llm_tuning_quality_scores.labels(
            model_id=str(model_id), 
            criteria=criteria
        ).observe(score)
    
    @staticmethod
    def record_rag_operation(operation_type: str, collection: str):
        """–ó–∞–ø–∏—Å—å RAG –æ–ø–µ—Ä–∞—Ü–∏–∏"""
        llm_tuning_rag_operations.labels(
            operation_type=operation_type, 
            collection=collection
        ).inc()
    
    @staticmethod
    def update_system_health(component: str, status: int):
        """–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã"""
        llm_tuning_system_health.labels(component=component).set(status)
```

### Middleware –¥–ª—è –º–µ—Ç—Ä–∏–∫

```python
# relink/backend/app/middleware/llm_tuning_metrics.py

from fastapi import Request
import time
from app.monitoring.llm_tuning_metrics import LLMTuningMetrics

async def llm_tuning_metrics_middleware(request: Request, call_next):
    """Middleware –¥–ª—è —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫ LLM Tuning"""
    start_time = time.time()
    
    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –∑–∞–ø—Ä–æ—Å –∫ LLM Tuning
    is_llm_tuning_request = request.url.path.startswith('/api/llm-tuning')
    
    response = await call_next(request)
    
    if is_llm_tuning_request:
        duration = time.time() - start_time
        LLMTuningMetrics.record_request(
            endpoint=request.url.path,
            method=request.method,
            status=str(response.status_code),
            duration=duration
        )
    
    return response
```

---

## üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### Docker Compose –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

```yaml
# relink/docker-compose.prod.yml

version: '3.8'

services:
  llm_tuning:
    build: ./llm_tuning
    image: relink/llm-tuning:latest
    ports:
      - "8000:8000"
    environment:
      - DATABASE_URL=postgresql://user:pass@db/llm_tuning
      - OLLAMA_BASE_URL=http://ollama:11434
      - REDIS_URL=redis://redis:6379
      - VECTOR_DB_URL=http://qdrant:6333
      - LOG_LEVEL=INFO
    depends_on:
      - db
      - redis
      - ollama
      - qdrant
    networks:
      - relink_network
    deploy:
      resources:
        limits:
          memory: 2G
          cpus: '2'
        reservations:
          memory: 1G
          cpus: '1'
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8000/health"]
      interval: 30s
      timeout: 10s
      retries: 3

  backend:
    build: ./backend
    image: relink/backend:latest
    environment:
      - LLM_TUNING_URL=http://llm_tuning:8000
      - LLM_TUNING_API_KEY=${LLM_TUNING_API_KEY}
      - LOG_LEVEL=INFO
    depends_on:
      llm_tuning:
        condition: service_healthy
    networks:
      - relink_network
    deploy:
      resources:
        limits:
          memory: 1G
          cpus: '1'
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8000/health"]
      interval: 30s
      timeout: 10s
      retries: 3

networks:
  relink_network:
    driver: bridge
```

### Kubernetes —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

```yaml
# relink/k8s/llm-tuning-deployment.yaml

apiVersion: apps/v1
kind: Deployment
metadata:
  name: llm-tuning
  namespace: relink
spec:
  replicas: 2
  selector:
    matchLabels:
      app: llm-tuning
  template:
    metadata:
      labels:
        app: llm-tuning
    spec:
      containers:
      - name: llm-tuning
        image: relink/llm-tuning:latest
        ports:
        - containerPort: 8000
        env:
        - name: DATABASE_URL
          valueFrom:
            secretKeyRef:
              name: llm-tuning-secrets
              key: database-url
        - name: OLLAMA_BASE_URL
          value: "http://ollama:11434"
        - name: REDIS_URL
          value: "redis://redis:6379"
        - name: VECTOR_DB_URL
          value: "http://qdrant:6333"
        resources:
          requests:
            memory: "1Gi"
            cpu: "500m"
          limits:
            memory: "2Gi"
            cpu: "1000m"
        livenessProbe:
          httpGet:
            path: /health
            port: 8000
          initialDelaySeconds: 30
          periodSeconds: 10
        readinessProbe:
          httpGet:
            path: /health
            port: 8000
          initialDelaySeconds: 5
          periodSeconds: 5

---
apiVersion: v1
kind: Service
metadata:
  name: llm-tuning-service
  namespace: relink
spec:
  selector:
    app: llm-tuning
  ports:
  - protocol: TCP
    port: 8000
    targetPort: 8000
  type: ClusterIP
```

---

## üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

1. **LLM Tuning –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω**
   ```bash
   # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
   curl http://localhost:8000/health
   
   # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
   docker-compose logs llm_tuning
   
   # –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞
   docker-compose restart llm_tuning
   ```

2. **–û—à–∏–±–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏**
   ```bash
   # –ü—Ä–æ–≤–µ—Ä–∫–∞ API –∫–ª—é—á–∞
   echo $LLM_TUNING_API_KEY
   
   # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–ª—é—á–∞
   export LLM_TUNING_API_KEY="new-api-key"
   docker-compose restart backend
   ```

3. **–ü—Ä–æ–±–ª–µ–º—ã —Å RAG**
   ```bash
   # –ü—Ä–æ–≤–µ—Ä–∫–∞ Vector DB
   curl http://localhost:6333/collections
   
   # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–ª–µ–∫—Ü–∏–π
   curl http://localhost:6333/collections/relink_docs
   
   # –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ Qdrant
   docker-compose restart qdrant
   ```

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

```bash
# –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
curl -X POST http://localhost:8000/api/v1/health/diagnostic \
  -H "Authorization: Bearer YOUR_TOKEN"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Ç—Ä–∏–∫
curl http://localhost:8000/metrics | grep llm_tuning

# –¢–µ—Å—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
python -m pytest tests/test_llm_tuning_integration.py -v
```

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [üìñ –û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è LLM Tuning](README.md)
- [üîó API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](docs/API_EXTENDED.md)
- [üîó –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](examples/)
- [üîó –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](config.py)
- [üîó –¢–µ—Å—Ç—ã](tests/)

---

*–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∞: 2024-01-01* 