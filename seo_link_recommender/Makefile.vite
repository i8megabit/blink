# üöÄ SEO Link Recommender - Vite Edition Makefile

.PHONY: help install dev build preview clean docker-build docker-dev docker-prod lint test

# –¶–≤–µ—Ç–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞
GREEN = \033[0;32m
YELLOW = \033[1;33m
RED = \033[0;31m
NC = \033[0m # No Color

# –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–º–æ—â—å
help:
	@echo "$(GREEN)üîó SEO Link Recommender - Vite Edition$(NC)"
	@echo "$(YELLOW)–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:$(NC)"
	@echo ""
	@echo "$(GREEN)Frontend –∫–æ–º–∞–Ω–¥—ã:$(NC)"
	@echo "  install      - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏"
	@echo "  dev          - –ó–∞–ø—É—Å—Ç–∏—Ç—å dev-—Å–µ—Ä–≤–µ—Ä —Å HMR"
	@echo "  build        - –°–æ–±—Ä–∞—Ç—å production –≤–µ—Ä—Å–∏—é"
	@echo "  preview      - –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä production —Å–±–æ—Ä–∫–∏"
	@echo "  lint         - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥ ESLint"
	@echo "  clean        - –û—á–∏—Å—Ç–∏—Ç—å —Ñ–∞–π–ª—ã —Å–±–æ—Ä–∫–∏"
	@echo ""
	@echo "$(GREEN)Docker –∫–æ–º–∞–Ω–¥—ã:$(NC)"
	@echo "  docker-build - –°–æ–±—Ä–∞—Ç—å Docker –æ–±—Ä–∞–∑—ã"
	@echo "  docker-dev   - –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤ dev —Ä–µ–∂–∏–º–µ"
	@echo "  docker-prod  - –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤ production —Ä–µ–∂–∏–º–µ"
	@echo "  docker-stop  - –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã"
	@echo "  docker-clean - –û—á–∏—Å—Ç–∏—Ç—å Docker –¥–∞–Ω–Ω—ã–µ"
	@echo ""
	@echo "$(GREEN)–£—Ç–∏–ª–∏—Ç—ã:$(NC)"
	@echo "  status       - –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞"
	@echo "  logs         - –ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤"

# Frontend –∫–æ–º–∞–Ω–¥—ã
install:
	@echo "$(GREEN)üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π...$(NC)"
	cd frontend && npm install

dev:
	@echo "$(GREEN)‚ö° –ó–∞–ø—É—Å–∫ Vite dev-—Å–µ—Ä–≤–µ—Ä–∞...$(NC)"
	cd frontend && npm run dev

build:
	@echo "$(GREEN)üî® –°–±–æ—Ä–∫–∞ production –≤–µ—Ä—Å–∏–∏...$(NC)"
	cd frontend && npm run build

preview:
	@echo "$(GREEN)üëÄ –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä production —Å–±–æ—Ä–∫–∏...$(NC)"
	cd frontend && npm run preview

lint:
	@echo "$(GREEN)üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞ ESLint...$(NC)"
	cd frontend && npm run lint

clean:
	@echo "$(GREEN)üßπ –û—á–∏—Å—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤ —Å–±–æ—Ä–∫–∏...$(NC)"
	cd frontend && npm run clean

# Docker –∫–æ–º–∞–Ω–¥—ã
docker-build:
	@echo "$(GREEN)üê≥ –°–±–æ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑–æ–≤...$(NC)"
	docker-compose -f docker-compose.vite.yml build

docker-dev:
	@echo "$(GREEN)üîß –ó–∞–ø—É—Å–∫ –≤ development —Ä–µ–∂–∏–º–µ...$(NC)"
	docker-compose -f docker-compose.vite.yml --profile dev up --build

docker-prod:
	@echo "$(GREEN)üöÄ –ó–∞–ø—É—Å–∫ –≤ production —Ä–µ–∂–∏–º–µ...$(NC)"
	docker-compose -f docker-compose.vite.yml up --build

docker-stop:
	@echo "$(YELLOW)‚èπÔ∏è  –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤...$(NC)"
	docker-compose -f docker-compose.vite.yml down

docker-clean:
	@echo "$(RED)üóëÔ∏è  –û—á–∏—Å—Ç–∫–∞ Docker –¥–∞–Ω–Ω—ã—Ö...$(NC)"
	docker-compose -f docker-compose.vite.yml down -v --rmi all
	docker system prune -f

# –£—Ç–∏–ª–∏—Ç—ã
status:
	@echo "$(GREEN)üìä –°—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞:$(NC)"
	@echo ""
	@echo "$(YELLOW)Frontend (Vite):$(NC)"
	@if [ -d "frontend/node_modules" ]; then \
		echo "  ‚úÖ Node modules —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã"; \
	else \
		echo "  ‚ùå Node modules –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã"; \
	fi
	@if [ -f "frontend/dist/index.html" ]; then \
		echo "  ‚úÖ Production —Å–±–æ—Ä–∫–∞ –≥–æ—Ç–æ–≤–∞"; \
	else \
		echo "  ‚ö†Ô∏è  Production —Å–±–æ—Ä–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç"; \
	fi
	@echo ""
	@echo "$(YELLOW)Docker:$(NC)"
	@docker-compose -f docker-compose.vite.yml ps || echo "  ‚ö†Ô∏è  –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –Ω–µ –∑–∞–ø—É—â–µ–Ω—ã"

logs:
	@echo "$(GREEN)üìã –õ–æ–≥–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤:$(NC)"
	docker-compose -f docker-compose.vite.yml logs -f

# –ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã
quick-start: install build docker-prod
	@echo "$(GREEN)üéâ –ü—Ä–æ–µ–∫—Ç –∑–∞–ø—É—â–µ–Ω! –î–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ http://localhost:3000$(NC)"

# –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
dev-setup: install
	@echo "$(GREEN)üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ dev –æ–∫—Ä—É–∂–µ–Ω–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞$(NC)"
	@echo "$(YELLOW)–ó–∞–ø—É—Å—Ç–∏—Ç–µ 'make dev' –¥–ª—è —Å—Ç–∞—Ä—Ç–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏$(NC)"

# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
perf-info:
	@echo "$(GREEN)‚ö° –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ Vite:$(NC)"
	@echo ""
	@echo "$(YELLOW)–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:$(NC)"
	@echo "  ‚Ä¢ Dev start: ~1s (vs ~10s —Å Babel)"
	@echo "  ‚Ä¢ HMR: ~50ms (vs ~3s —Å Babel)"
	@echo "  ‚Ä¢ Bundle size: ~300KB (vs ~1.5MB —Å Babel)"
	@echo "  ‚Ä¢ Build time: ~5s (vs ~30s —Å Babel)"
	@echo ""
	@echo "$(YELLOW)–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:$(NC)"
	@echo "  ‚Ä¢ –ù–∞—Ç–∏–≤–Ω—ã–π ES modules"
	@echo "  ‚Ä¢ ESBuild –¥–ª—è —Ç—Ä–∞–Ω—Å–ø–∏–ª—è—Ü–∏–∏"
	@echo "  ‚Ä¢ Tailwind CSS –¥–ª—è —Å—Ç–∏–ª–µ–π"
	@echo "  ‚Ä¢ React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≤–º–µ—Å—Ç–æ –º–æ–Ω–æ–ª–∏—Ç–Ω–æ–≥–æ HTML"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
check-deps:
	@echo "$(GREEN)üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π...$(NC)"
	@which node > /dev/null || (echo "$(RED)‚ùå Node.js –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω$(NC)" && exit 1)
	@which npm > /dev/null || (echo "$(RED)‚ùå npm –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω$(NC)" && exit 1)
	@which docker > /dev/null || (echo "$(RED)‚ùå Docker –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω$(NC)" && exit 1)
	@which docker-compose > /dev/null || (echo "$(RED)‚ùå Docker Compose –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω$(NC)" && exit 1)
	@echo "$(GREEN)‚úÖ –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã$(NC)"

# –ö–æ–º–∞–Ω–¥–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Å–µ—Ö –≤–µ—Ä—Å–∏–π
test-all-versions:
	@echo "$(GREEN)üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –≤–µ—Ä—Å–∏–π:$(NC)"
	@echo ""
	@echo "$(YELLOW)1. Babel –≤–µ—Ä—Å–∏—è (—Å—Ç–∞—Ä–∞—è):$(NC)"
	@echo "   –û—Ç–∫—Ä–æ–π—Ç–µ: frontend/index.html"
	@echo ""
	@echo "$(YELLOW)2. React –±–µ–∑ JSX:$(NC)"
	@echo "   –û—Ç–∫—Ä–æ–π—Ç–µ: frontend/index-no-babel.html"
	@echo ""
	@echo "$(YELLOW)3. Vite –≤–µ—Ä—Å–∏—è (–Ω–æ–≤–∞—è):$(NC)"
	@echo "   –í—ã–ø–æ–ª–Ω–∏—Ç–µ: make dev"
	@echo "   –î–æ—Å—Ç—É–ø–Ω–æ –Ω–∞: http://localhost:3000"

# –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
migrate:
	@echo "$(GREEN)üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ Vite...$(NC)"
	@echo "$(YELLOW)–í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞...$(NC)"
	@make install
	@echo "$(GREEN)‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!$(NC)"
	@echo "$(YELLOW)–¢–µ–ø–µ—Ä—å –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å 'make dev' –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏$(NC)"

.DEFAULT_GOAL := help 