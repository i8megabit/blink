<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SEO Link Recommender</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css" />
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
  <style>
    .analysis-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.85);
      z-index: 9999;
      display: flex;
      align-items: center;
      justify-content: center;
      backdrop-filter: blur(8px);
    }
    
    .analysis-window {
      background: white;
      border-radius: 12px;
      padding: 2rem;
      max-width: 800px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
      animation: slideIn 0.3s ease-out;
    }
    
    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .log-entry {
      padding: 0.75rem 1rem;
      margin: 0.5rem 0;
      border-radius: 8px;
      border-left: 4px solid;
      font-family: 'Consolas', 'Monaco', monospace;
      font-size: 0.9rem;
      animation: fadeInUp 0.3s ease-out;
    }
    
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .log-info {
      background: #e8f4fd;
      border-left-color: #3273dc;
      color: #296fa8;
    }
    
    .log-success {
      background: #effaf3;
      border-left-color: #48c774;
      color: #257942;
    }
    
    .log-warning {
      background: #fffaeb;
      border-left-color: #ffdd57;
      color: #947600;
    }
    
    .log-error {
      background: #feecf0;
      border-left-color: #f14668;
      color: #cc0f35;
    }
    
    .hero-gradient {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
    
    .step-card {
      border: 2px solid transparent;
      transition: all 0.3s ease;
    }
    
    .step-card.active {
      border-color: #3273dc;
      box-shadow: 0 4px 12px rgba(50, 115, 220, 0.15);
    }
    
    .step-card.completed {
      border-color: #48c774;
      background: #f0fff4;
    }
    
    .analysis-stats {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      color: white;
      border-radius: 12px;
      padding: 1.5rem;
      margin: 1rem 0;
    }
  </style>
</head>
<body>
  <div id="app"></div>
  <script type="text/babel">
    function App() {
      const [domain, setDomain] = React.useState('');
      const [error, setError] = React.useState('');
      const [analysisStep, setAnalysisStep] = React.useState('input'); // 'input', 'analyzing', 'results'
      const [analysisHistory, setAnalysisHistory] = React.useState([]);
      const [selectedAnalysis, setSelectedAnalysis] = React.useState(null);
      const [currentView, setCurrentView] = React.useState('main'); // 'main', 'history', 'analysis'
      
      // Real-time analysis states
      const [analysisLogs, setAnalysisLogs] = React.useState([]);
      const [analysisStats, setAnalysisStats] = React.useState(null);
      const [websocket, setWebsocket] = React.useState(null);
      const [clientId, setClientId] = React.useState(null);
      const [connectionStatus, setConnectionStatus] = React.useState('disconnected');
      const [currentAnalysisId, setCurrentAnalysisId] = React.useState(null);
      const [recommendations, setRecommendations] = React.useState([]);

      React.useEffect(() => { 
        console.log('üöÄ SEO Link Recommender –∑–∞–≥—Ä—É–∂–µ–Ω');
        
        // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –∫–ª–∏–µ–Ω—Ç–∞
        const newClientId = 'client_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        setClientId(newClientId);
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é –∞–Ω–∞–ª–∏–∑–æ–≤
        loadAnalysisHistory();
        
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
        connectWebSocket(newClientId);
        
        return () => {
          if (websocket) {
            websocket.close();
          }
        };
      }, []);
      
      // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å WebSocket
      function connectWebSocket(clientId) {
        if (!clientId) return;
        
        setConnectionStatus('connecting');
        console.log('üîå –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ WebSocket...', clientId);
        
        const ws = new WebSocket(`ws://localhost:8000/ws/${clientId}`);
        
        ws.onopen = () => {
          console.log('‚úÖ WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω');
          setConnectionStatus('connected');
          setWebsocket(ws);
          addLog('success', 'WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ');
        };
        
        ws.onmessage = (event) => {
          try {
            const data = JSON.parse(event.data);
            handleWebSocketMessage(data);
          } catch (err) {
            console.error('‚ùå –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ WebSocket —Å–æ–æ–±—â–µ–Ω–∏—è:', err);
          }
        };
        
        ws.onclose = () => {
          console.log('üîå WebSocket –æ—Ç–∫–ª—é—á–µ–Ω');
          setConnectionStatus('disconnected');
          setWebsocket(null);
          
          // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
          setTimeout(() => connectWebSocket(clientId), 3000);
        };
        
        ws.onerror = (error) => {
          console.error('‚ùå –û—à–∏–±–∫–∞ WebSocket:', error);
          addLog('error', '–û—à–∏–±–∫–∞ WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è');
        };
      }
      
      function handleWebSocketMessage(data) {
        console.log('üì® WebSocket —Å–æ–æ–±—â–µ–Ω–∏–µ:', data);
        
        switch (data.type) {
          case 'progress':
            addLog('info', `${data.step} (${data.current}/${data.total})`, data.details);
            setAnalysisStats({
              step: data.step,
              current: data.current,
              total: data.total,
              percentage: data.percentage,
              details: data.details
            });
            break;
            
          case 'ollama':
            if (data.info.status === 'starting') {
              addLog('info', 'ü§ñ –ó–∞–ø—É—Å–∫ Ollama –∞–Ω–∞–ª–∏–∑–∞', 
                `–ú–æ–¥–µ–ª—å: ${data.info.model}, –°—Ç–∞—Ç–µ–π: ${data.info.articles_count}`);
            } else if (data.info.status === 'completed') {
              addLog('success', 'ü§ñ Ollama –∑–∞–≤–µ—Ä—à–∏–ª–∞ –∞–Ω–∞–ª–∏–∑', 
                `–í—Ä–µ–º—è: ${data.info.request_time}, –û—Ç–≤–µ—Ç: ${data.info.response_length} —Å–∏–º–≤–æ–ª–æ–≤`);
            }
            break;
            
          case 'error':
            addLog('error', data.message, data.details);
            setError(data.message);
            // –ü—Ä–∏ –æ—à–∏–±–∫–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –∫ –≤–≤–æ–¥—É
            setTimeout(() => {
              setAnalysisStep('input');
              setAnalysisLogs([]);
              setAnalysisStats(null);
            }, 5000);
            break;
            
          case 'complete':
            addLog('success', '‚úÖ –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ!', 
              `–ù–∞–π–¥–µ–Ω–æ ${data.recommendations_count} —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –∏–∑ ${data.posts_count} —Å—Ç–∞—Ç–µ–π`);
            
            // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
              setAnalysisStep('results');
              loadAnalysisHistory(); // –û–±–Ω–æ–≤–ª—è–µ–º –∏—Å—Ç–æ—Ä–∏—é
            }, 2000);
            break;
        }
      }
      
      function addLog(type, message, details = '') {
        const logEntry = {
          id: Date.now() + Math.random(),
          type,
          message,
          details,
          timestamp: new Date().toLocaleTimeString()
        };
        
        setAnalysisLogs(prev => [...prev, logEntry]);
        console.log(`üìù [${type.toUpperCase()}] ${message}`, details);
      }

      async function loadAnalysisHistory() {
        try {
          const resp = await fetch('http://localhost:8000/api/v1/analysis_history');
          if (!resp.ok) throw new Error(`HTTP ${resp.status}`);
          
          const data = await resp.json();
          setAnalysisHistory(data);
          console.log('üì• –ò—Å—Ç–æ—Ä–∏—è –∞–Ω–∞–ª–∏–∑–æ–≤ –∑–∞–≥—Ä—É–∂–µ–Ω–∞:', data.length);
        } catch (err) {
          console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏—Å—Ç–æ—Ä–∏–∏:', err);
          setError(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏—Å—Ç–æ—Ä–∏–∏: ${err.message}`);
        }
      }

      async function startAnalysis() {
        if (!domain.trim()) { 
          setError('–í–≤–µ–¥–∏—Ç–µ DNS –∏–º—è —Å–∞–π—Ç–∞');
          return; 
        }
        
        if (!clientId || connectionStatus !== 'connected') {
          setError('WebSocket –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.');
          return;
        }
        
        setError('');
        setAnalysisStep('analyzing');
        setAnalysisLogs([]);
        setAnalysisStats(null);
        setRecommendations([]);
        
        const analysisId = 'analysis_' + Date.now();
        setCurrentAnalysisId(analysisId);
        
        addLog('info', `üöÄ –ù–∞—á–∏–Ω–∞—é –∞–Ω–∞–ª–∏–∑ —Å–∞–π—Ç–∞: ${domain}`, '–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ WordPress API...');
        
        try {
          const resp = await fetch('http://localhost:8000/api/v1/wp_recommend', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ 
              domain: domain,
              client_id: clientId
            })
          });
          
          if (!resp.ok) {
            const errorText = await resp.text();
            throw new Error(`HTTP ${resp.status}: ${errorText}`);
          }
          
          const data = await resp.json();
          setRecommendations(data.recommendations || []);
          
        } catch (err) {
          console.error('‚ùå –û—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞:', err);
          addLog('error', '–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞', err.message);
          setError(`–û—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞: ${err.message}`);
        }
      }
      
      function resetAnalysis() {
        setAnalysisStep('input');
        setAnalysisLogs([]);
        setAnalysisStats(null);
        setRecommendations([]);
        setCurrentAnalysisId(null);
        setError('');
      }

      // –ê–Ω–∞–ª–∏–∑ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ - –∫—Ä–∞—Å–∏–≤–æ–µ –∑–∞—Ç–µ–Ω–µ–Ω–Ω–æ–µ –æ–∫–Ω–æ
      function AnalysisOverlay() {
        if (analysisStep !== 'analyzing') return null;
        
        return (
          <div className="analysis-overlay">
            <div className="analysis-window">
              <div className="has-text-centered mb-4">
                <h2 className="title is-4">
                  üîç –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Å–∞–π—Ç {domain}
                </h2>
                <p className="subtitle is-6 has-text-grey">
                  Real-time –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∞–Ω–∞–ª–∏–∑–∞
                </p>
              </div>
              
              {/* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∞–Ω–∞–ª–∏–∑–∞ */}
              {analysisStats && (
                <div className="analysis-stats">
                  <div className="columns is-mobile">
                    <div className="column">
                      <div className="has-text-weight-bold is-size-5">
                        {analysisStats.step}
                      </div>
                      <div className="is-size-7">
                        {analysisStats.current}/{analysisStats.total} ({analysisStats.percentage}%)
                      </div>
                    </div>
                    <div className="column is-narrow">
                      <div className="is-size-1">
                        {analysisStats.percentage === 100 ? '‚úÖ' : '‚öôÔ∏è'}
                      </div>
                    </div>
                  </div>
                  <progress 
                    className="progress is-white is-small" 
                    value={analysisStats.percentage} 
                    max="100"
                  >
                    {analysisStats.percentage}%
                  </progress>
                  <div className="is-size-7 mt-2">
                    {analysisStats.details}
                  </div>
                </div>
              )}
              
              {/* –õ–æ–≥–∏ –∞–Ω–∞–ª–∏–∑–∞ */}
              <div className="box" style={{maxHeight: '400px', overflowY: 'auto', background: '#fafafa'}}>
                <h5 className="title is-6 mb-3">üìù –õ–æ–≥–∏ –∞–Ω–∞–ª–∏–∑–∞</h5>
                {analysisLogs.length === 0 ? (
                  <p className="has-text-grey">–û–∂–∏–¥–∞–Ω–∏–µ –ª–æ–≥–æ–≤...</p>
                ) : (
                  analysisLogs.map(log => (
                    <div key={log.id} className={`log-entry log-${log.type}`}>
                      <div className="is-flex is-justify-content-space-between is-align-items-flex-start">
                        <div className="is-flex-grow-1">
                          <div className="has-text-weight-semibold">
                            [{log.timestamp}] {log.message}
                          </div>
                          {log.details && (
                            <div className="is-size-7 mt-1 has-text-grey-dark">
                              {log.details}
                            </div>
                          )}
                        </div>
                      </div>
                    </div>
                  ))
                )}
              </div>
              
              {/* –°—Ç–∞—Ç—É—Å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è */}
              <div className="level mt-4">
                <div className="level-left">
                  <div className="level-item">
                    <span className={`tag ${
                      connectionStatus === 'connected' ? 'is-success' : 
                      connectionStatus === 'connecting' ? 'is-warning' : 'is-danger'
                    }`}>
                      {connectionStatus === 'connected' ? 'üü¢ –ü–æ–¥–∫–ª—é—á–µ–Ω–æ' : 
                       connectionStatus === 'connecting' ? 'üü° –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...' : 'üî¥ –û—Ç–∫–ª—é—á–µ–Ω–æ'}
                    </span>
                  </div>
                </div>
                <div className="level-right">
                  <div className="level-item">
                    <button 
                      className="button is-light"
                      onClick={resetAnalysis}
                    >
                      ‚ùå –ü—Ä–µ—Ä–≤–∞—Ç—å –∞–Ω–∞–ª–∏–∑
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        );
      }

      return (
        <div>
          <AnalysisOverlay />
          
          {/* –ì–ª–∞–≤–Ω–∞—è —Å–µ–∫—Ü–∏—è */}
          <section className="hero hero-gradient">
            <div className="hero-body">
              <div className="container has-text-centered">
                <h1 className="title is-2 has-text-white">
                  SEO Link Recommender
                </h1>
                <p className="subtitle is-4 has-text-white-ter">
                  –£–º–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —Å—Å—ã–ª–æ–∫ –¥–ª—è –≤–∞—à–µ–≥–æ WordPress —Å–∞–π—Ç–∞
                </p>
              </div>
            </div>
          </section>
          
          <section className="section">
            <div className="container">
              {/* –ù–∞–≤–∏–≥–∞—Ü–∏—è */}
              <nav className="level mb-5">
                <div className="level-left">
                  <div className="buttons">
                    <button 
                      className={`button ${currentView === 'main' ? 'is-primary' : 'is-light'}`}
                      onClick={() => setCurrentView('main')}
                    >
                      üè† –ì–ª–∞–≤–Ω–∞—è
                    </button>
                    <button 
                      className={`button ${currentView === 'history' ? 'is-primary' : 'is-light'}`}
                      onClick={() => setCurrentView('history')}
                    >
                      üìä –ò—Å—Ç–æ—Ä–∏—è –∞–Ω–∞–ª–∏–∑–æ–≤ ({analysisHistory.length})
                    </button>
                  </div>
                </div>
              </nav>
            
              {/* –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ */}
              {currentView === 'main' && (
                <div className="columns is-centered">
                  <div className="column is-8">
                    
                    {/* –≠—Ç–∞–ø 1: –í–≤–æ–¥ DNS */}
                    {analysisStep === 'input' && (
                      <div className="step-card box active">
                        <h2 className="title is-4 has-text-centered mb-5">
                          üåê –í–≤–µ–¥–∏—Ç–µ DNS –∏–º—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
                        </h2>
                        
                        <div className="field">
                          <label className="label is-medium">DNS –∏–º—è —Å–∞–π—Ç–∞</label>
                          <div className="control is-large">
                            <input 
                              className="input is-large" 
                              type="text"
                              placeholder="example.com (–±–µ–∑ https://)" 
                              value={domain} 
                              onChange={e => setDomain(e.target.value)}
                              onKeyPress={e => e.key === 'Enter' && startAnalysis()}
                            />
                          </div>
                          <p className="help">
                            –í–≤–µ–¥–∏—Ç–µ —Ç–æ–ª—å–∫–æ DNS –∏–º—è (–Ω–∞–ø—Ä–∏–º–µ—Ä: site.ru), –±–µ–∑ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ –∏ —Å–ª—ç—à–µ–π
                          </p>
                        </div>
                        
                        <div className="has-text-centered mt-5">
                          <button 
                            className="button is-primary is-large"
                            onClick={startAnalysis}
                            disabled={!domain.trim() || connectionStatus !== 'connected'}
                          >
                            <span className="icon">
                              <i>üöÄ</i>
                            </span>
                            <span>–ü–æ–ª—É—á–∏—Ç—å —Å—Å—ã–ª–∫–∏</span>
                          </button>
                        </div>
                        
                        {/* –°—Ç–∞—Ç—É—Å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è */}
                        <div className="has-text-centered mt-3">
                          <span className={`tag ${
                            connectionStatus === 'connected' ? 'is-success' : 
                            connectionStatus === 'connecting' ? 'is-warning' : 'is-danger'
                          }`}>
                            WebSocket: {connectionStatus === 'connected' ? '–ì–æ—Ç–æ–≤' : 
                                      connectionStatus === 'connecting' ? '–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ...' : '–ù–µ—Ç —Å–≤—è–∑–∏'}
                          </span>
                        </div>
                      </div>
                    )}
                    
                    {/* –≠—Ç–∞–ø 2: –†–µ–∑—É–ª—å—Ç–∞—Ç—ã */}
                    {analysisStep === 'results' && (
                      <div className="step-card box completed">
                        <div className="level">
                          <div className="level-left">
                            <div className="level-item">
                              <h2 className="title is-4">
                                ‚úÖ –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω: {domain}
                              </h2>
                            </div>
                          </div>
                          <div className="level-right">
                            <div className="level-item">
                              <button 
                                className="button is-primary"
                                onClick={resetAnalysis}
                              >
                                üîÑ –ù–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑
                              </button>
                            </div>
                          </div>
                        </div>
                        
                        {recommendations.length > 0 ? (
                          <div>
                            <div className="notification is-success is-light mb-4">
                              <strong>–ù–∞–π–¥–µ–Ω–æ {recommendations.length} —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –ø–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º —Å—Å—ã–ª–∫–∞–º!</strong>
                              <br />
                              –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ –∏—Å—Ç–æ—Ä–∏—é –∞–Ω–∞–ª–∏–∑–æ–≤.
                            </div>
                            
                            <table className="table is-striped is-fullwidth">
                              <thead>
                                <tr>
                                  <th>–û—Ç–∫—É–¥–∞</th>
                                  <th>–ö—É–¥–∞</th>
                                  <th>–ê–Ω–∫–æ—Ä</th>
                                  <th>–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –ò–ò</th>
                                </tr>
                              </thead>
                              <tbody>
                                {recommendations.map((rec, i) => (
                                  <tr key={i}>
                                    <td>
                                      <a href={rec.from} target="_blank" rel="noopener" className="is-size-7">
                                        {rec.from.replace('https://', '').substring(0, 40)}...
                                      </a>
                                    </td>
                                    <td>
                                      <a href={rec.to} target="_blank" rel="noopener" className="is-size-7">
                                        {rec.to.replace('https://', '').substring(0, 40)}...
                                      </a>
                                    </td>
                                    <td>
                                      <div className="field has-addons">
                                        <div className="control is-expanded">
                                          <input 
                                            className="input is-small" 
                                            value={rec.anchor} 
                                            readOnly 
                                          />
                                        </div>
                                        <div className="control">
                                          <button 
                                            className="button is-small is-primary"
                                            onClick={() => {
                                              navigator.clipboard.writeText(rec.anchor);
                                            }}
                                            title="–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∞–Ω–∫–æ—Ä"
                                          >
                                            üìã
                                          </button>
                                        </div>
                                      </div>
                                    </td>
                                    <td>
                                      <p className="is-size-7 has-text-grey">
                                        {rec.comment}
                                      </p>
                                    </td>
                                  </tr>
                                ))}
                              </tbody>
                            </table>
                          </div>
                        ) : (
                          <div className="notification is-warning">
                            <strong>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.</strong>
                            <br />
                            –í–æ–∑–º–æ–∂–Ω–æ, –Ω–∞ —Å–∞–π—Ç–µ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ç–∞—Ç–µ–π –∏–ª–∏ –æ–Ω–∏ –Ω–µ —Å–≤—è–∑–∞–Ω—ã —Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏.
                          </div>
                        )}
                      </div>
                    )}
                    
                    {/* –û—à–∏–±–∫–∏ */}
                    {error && (
                      <div className="notification is-danger">
                        <button className="delete" onClick={() => setError('')}></button>
                        <strong>–û—à–∏–±–∫–∞:</strong> {error}
                      </div>
                    )}
                  </div>
                </div>
              )}
              
              {/* –ò—Å—Ç–æ—Ä–∏—è –∞–Ω–∞–ª–∏–∑–æ–≤ */}
              {currentView === 'history' && (
                <div className="content">
                  <h2 className="title is-3">üìä –ò—Å—Ç–æ—Ä–∏—è –∞–Ω–∞–ª–∏–∑–æ–≤</h2>
                  {analysisHistory.length === 0 ? (
                    <div className="notification is-info">
                      <p>–ò—Å—Ç–æ—Ä–∏—è –∞–Ω–∞–ª–∏–∑–æ–≤ –ø—É—Å—Ç–∞. –ü—Ä–æ–≤–µ–¥–∏—Ç–µ –ø–µ—Ä–≤—ã–π –∞–Ω–∞–ª–∏–∑ WordPress —Å–∞–π—Ç–∞!</p>
                    </div>
                  ) : (
                    <div className="columns is-multiline">
                      {analysisHistory.map(analysis => (
                        <div key={analysis.id} className="column is-one-third">
                          <div className="card" style={{height: '100%'}}>
                            <div className="card-header">
                              <div className="card-header-title">
                                <span className="icon"><i>üåê</i></span>
                                <span>{analysis.domain}</span>
                              </div>
                            </div>
                            <div className="card-content" style={{flexGrow: 1}}>
                              <div className="content">
                                <time className="has-text-grey-light is-size-7">
                                  {new Date(analysis.created_at).toLocaleString('ru-RU')}
                                </time>
                                <p className="mt-2">{analysis.summary}</p>
                              </div>
                            </div>
                            <div className="card-footer" style={{flexDirection: 'column', alignItems: 'stretch'}}>
                              <div className="card-footer-item" style={{justifyContent: 'center', borderBottom: '1px solid #dbdbdb', padding: '0.75rem'}}>
                                <div className="field is-grouped">
                                  <div className="control">
                                    <div className="tags has-addons">
                                      <span className="tag is-dark">–°—Ç–∞—Ç–µ–π</span>
                                      <span className="tag is-info">{analysis.posts_count}</span>
                                    </div>
                                  </div>
                                  <div className="control">
                                    <div className="tags has-addons">
                                      <span className="tag is-dark">–°—Å—ã–ª–æ–∫</span>
                                      <span className="tag is-success">{analysis.recommendations_count}</span>
                                    </div>
                                  </div>
                                </div>
                              </div>
                              <div className="card-footer-item" style={{padding: '0'}}>
                                <button 
                                  className="button is-primary is-fullwidth"
                                  style={{border: 'none', borderRadius: '0'}}
                                  onClick={() => {
                                    setSelectedAnalysis(analysis);
                                    setRecommendations(analysis.recommendations);
                                    setAnalysisStep('results');
                                    setDomain(analysis.domain);
                                    setCurrentView('main');
                                  }}
                                >
                                  üëÅÔ∏è –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
                                </button>
                              </div>
                            </div>
                          </div>
                        </div>
                      ))}
                    </div>
                  )}
                </div>
              )}
            </div>
          </section>
        </div>
      );
    }

    console.log('üéØ –ó–∞–ø—É—Å–∫–∞—é –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ...');
    ReactDOM.createRoot(document.getElementById('app')).render(<App />);
  </script>
</body>
</html>
